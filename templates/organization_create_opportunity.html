{% extends "base.html" %}

{% block title %}Create Opportunity - VolunteerHub{% endblock %}

{% block extra_css %}
<style>
    /* Hide main site navigation */
    #navbar {
        display: none;
    }
    
    body {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        min-height: 100vh;
    }

    .org-container {
        max-width: 1600px;
        margin: 40px auto 60px;
        padding: 0 60px;
    }

    .org-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 40px;
        padding-bottom: 20px;
        border-bottom: 2px solid #e9ecef;
    }

    .org-header h1 {
        color: #0f4c5c;
        font-size: 36px;
        display: flex;
        align-items: center;
        gap: 15px;
        margin: 0;
    }

    .logout-btn {
        padding: 10px 20px;
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 6px;
        font-weight: 600;
        text-decoration: none;
    }

    .logout-btn:hover {
        background: #c82333;
    }

    .org-nav {
        display: flex;
        gap: 20px;
        margin-bottom: 40px;
    }

    .org-nav a {
        padding: 12px 24px;
        background: white;
        color: #0f4c5c;
        text-decoration: none;
        border-radius: 8px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .org-nav a:hover {
        background: #0f4c5c;
        color: white;
        transform: translateY(-2px);
    }

    .org-nav a.active {
        background: linear-gradient(135deg, #5fb3c5 0%, #0f4c5c 100%);
        color: white;
    }

    
    .form-container {
        background: white;
        border-radius: 15px;
        padding: 2.5rem;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        max-width: 900px;
        margin: 0 auto;
    }
    
    .form-header {
        text-align: center;
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 3px solid #5fb3c5;
    }
    
    .form-header h2 {
        color: #0f4c5c;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }
    
    .form-header p {
        color: #666;
        margin: 0;
    }
    
    .form-section {
        margin-bottom: 2.5rem;
    }
    
    .form-section h4 {
        color: #0f4c5c;
        margin-bottom: 1.5rem;
        font-weight: 600;
    }
    
    .form-section h4 i {
        color: #5fb3c5;
        margin-right: 0.5rem;
    }
    
    .form-group {
        margin-bottom: 1.5rem;
    }
    
    .form-label {
        font-weight: 600;
        color: #0f4c5c;
        margin-bottom: 0.5rem;
    }
    
    .form-label .required {
        color: #dc3545;
    }
    
    .form-control, .form-select {
        border: 2px solid #ddd;
        border-radius: 8px;
        padding: 0.75rem;
        font-size: 1rem;
        transition: border-color 0.3s;
    }
    
    .form-control:focus, .form-select:focus {
        border-color: #5fb3c5;
        box-shadow: 0 0 0 0.2rem rgba(95, 179, 197, 0.25);
    }
    
    .form-text {
        font-size: 0.875rem;
        color: #666;
        margin-top: 0.25rem;
    }
    
    .time-slots-container {
        background: #f8f9fa;
        padding: 1.5rem;
        border-radius: 10px;
        margin-top: 1rem;
    }
    
    .time-slot-row {
        display: flex;
        gap: 1rem;
        align-items: center;
        margin-bottom: 1rem;
        padding: 1rem;
        background: white;
        border-radius: 8px;
        border: 2px solid #e9ecef;
    }
    
    .time-slot-row input {
        flex: 1;
    }
    
    .btn-remove-slot {
        background: #dc3545;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .btn-remove-slot:hover {
        background: #c82333;
    }
    
    .btn-add-slot {
        background: linear-gradient(135deg, #5fb3c5, #0f4c5c);
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        width: 100%;
        transition: all 0.3s;
    }
    
    .btn-add-slot:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(95, 179, 197, 0.3);
    }
    
    .btn-submit {
        background: linear-gradient(135deg, #00d4ff, #5fb3c5);
        color: white;
        border: none;
        padding: 1rem 3rem;
        border-radius: 10px;
        font-weight: 700;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .btn-submit:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 212, 255, 0.4);
    }
    
    .btn-cancel {
        background: white;
        color: #0f4c5c;
        border: 2px solid #5fb3c5;
        padding: 1rem 3rem;
        border-radius: 10px;
        font-weight: 700;
        font-size: 1.2rem;
        transition: all 0.3s;
    }
    
    .btn-cancel:hover {
        background: rgba(95, 179, 197, 0.1);
        color: #0f4c5c;
    }
    
    .char-counter {
        font-size: 0.85rem;
        color: #666;
        text-align: right;
        margin-top: 0.25rem;
    }
    
    .info-box {
        background: #e7f5f8;
        border-left: 4px solid #5fb3c5;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
    }
    
    .info-box i {
        color: #5fb3c5;
        margin-right: 0.5rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="org-container">
    <div class="org-header">
        <h1>âž• Create New Opportunity</h1>
        <a href="{{ url_for('logout') }}" class="logout-btn">Logout</a>
    </div>

    <!-- Organization Navigation Bar -->
    <div class="org-nav">
        <a href="{{ url_for('organization_dashboard') }}">Dashboard</a>
        <a href="{{ url_for('organization_opportunities') }}" class="active">My Opportunities</a>
        <a href="{{ url_for('organization_volunteers') }}">Volunteers</a>
        <a href="{{ url_for('organization_profile') }}">Profile</a>
    </div>
    
    <!-- Form Container -->
    <div class="form-container">        
        <form method="POST" action="{{ url_for('organization_create_opportunity') }}" id="opportunityForm">
            <!-- Basic Information -->
            <div class="form-section">
                <h4><i class="fas fa-info-circle"></i> Basic Information</h4>
                
                <div class="form-group">
                    <label class="form-label">
                        Opportunity Title <span class="required">*</span>
                    </label>
                    <input 
                        type="text" 
                        class="form-control" 
                        name="title" 
                        required
                        placeholder="e.g., Beach Cleanup, Food Bank Helper"
                    >
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        Description <span class="required">*</span>
                    </label>
                    <textarea 
                        class="form-control" 
                        name="description" 
                        rows="5"
                        maxlength="1000"
                        onkeyup="updateCharCount(this, 'descCharCount')"
                        required
                        placeholder="Provide a detailed description of the volunteer opportunity..."
                    ></textarea>
                    <div class="char-counter">
                        <span id="descCharCount">0</span> / 1000 characters
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">
                                Category <span class="required">*</span>
                            </label>
                            <select class="form-select" name="category" required>
                                <option value="">Select a category...</option>
                                <option value="Environment">Environment</option>
                                <option value="Education">Education</option>
                                <option value="Community">Community</option>
                                <option value="Health">Health</option>
                                <option value="Animals">Animals</option>
                                <option value="Arts & Culture">Arts & Culture</option>
                                <option value="Technology">Technology</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">
                                Hours per Slot <span class="required">*</span>
                            </label>
                            <input 
                                type="number" 
                                class="form-control" 
                                name="hours" 
                                min="1" 
                                max="8"
                                required
                                placeholder="1"
                            >
                            <small class="form-text">Typically 1-4 hours per time slot</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Date & Time -->
            <div class="form-section">
                <h4><i class="fas fa-calendar-alt"></i> Date & Time Slots</h4>
                
                <div class="info-box">
                    <i class="fas fa-lightbulb"></i>
                    <strong>OpenTable-style booking:</strong> Add multiple time slots for volunteers to choose from. Each slot can accommodate multiple volunteers.
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        Event Date <span class="required">*</span>
                    </label>
                    <input 
                        type="date" 
                        class="form-control" 
                        name="date" 
                        required
                        min="{{ today }}"
                    >
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        Time Slots <span class="required">*</span>
                    </label>
                    <div class="time-slots-container" id="timeSlotsContainer">
                        <div class="time-slot-row">
                            <input 
                                type="time" 
                                class="form-control" 
                                name="time_slots[]" 
                                required
                            >
                            <input 
                                type="number" 
                                class="form-control" 
                                name="spots_per_slot[]" 
                                min="1" 
                                max="50"
                                placeholder="Spots available"
                                required
                            >
                            <button type="button" class="btn-remove-slot" onclick="removeTimeSlot(this)">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <button type="button" class="btn-add-slot" onclick="addTimeSlot()">
                        <i class="fas fa-plus"></i> Add Another Time Slot
                    </button>
                </div>
            </div>
            
            <!-- Location -->
            <div class="form-section">
                <h4><i class="fas fa-map-marker-alt"></i> Location</h4>
                
                <div class="form-group">
                    <label class="form-label">
                        Street Address <span class="required">*</span>
                    </label>
                    <input 
                        type="text" 
                        class="form-control" 
                        name="address" 
                        required
                        placeholder="123 Main Street"
                    >
                </div>
                
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="form-label">
                                City <span class="required">*</span>
                            </label>
                            <input 
                                type="text" 
                                class="form-control" 
                                name="city" 
                                required
                            >
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="form-label">
                                State <span class="required">*</span>
                            </label>
                            <input 
                                type="text" 
                                class="form-control" 
                                name="state" 
                                value="MA"
                                required
                            >
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="form-label">
                                ZIP Code <span class="required">*</span>
                            </label>
                            <input 
                                type="text" 
                                class="form-control" 
                                name="zip_code" 
                                required
                                pattern="[0-9]{5}"
                            >
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Additional Details -->
            <div class="form-section">
                <h4><i class="fas fa-clipboard-list"></i> Additional Details</h4>
                
                <div class="form-group">
                    <label class="form-label">Requirements</label>
                    <textarea 
                        class="form-control" 
                        name="requirements" 
                        rows="3"
                        placeholder="e.g., Must be 18+, Background check required, Physical fitness needed"
                    ></textarea>
                    <small class="form-text">List any requirements or qualifications needed</small>
                </div>
                
                <div class="form-group">
                    <label class="form-label">What to Bring</label>
                    <textarea 
                        class="form-control" 
                        name="what_to_bring" 
                        rows="3"
                        placeholder="e.g., Water bottle, Comfortable shoes, Sunscreen"
                    ></textarea>
                    <small class="form-text">Items volunteers should bring</small>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Image URL</label>
                    <input 
                        type="url" 
                        class="form-control" 
                        name="image_url" 
                        placeholder="https://example.com/image.jpg"
                    >
                    <small class="form-text">Provide a URL for an image representing this opportunity</small>
                </div>
            </div>
            
            <!-- Form Actions -->
            <div class="text-center">
                <button type="submit" class="btn btn-submit me-3">
                    <i class="fas fa-check-circle"></i> Create Opportunity
                </button>
                <a href="{{ url_for('organization_opportunities') }}" class="btn btn-cancel">
                    <i class="fas fa-times"></i> Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<script>
function updateCharCount(textarea, counterId) {
    document.getElementById(counterId).textContent = textarea.value.length;
}

function addTimeSlot() {
    const container = document.getElementById('timeSlotsContainer');
    const newRow = document.createElement('div');
    newRow.className = 'time-slot-row';
    newRow.innerHTML = `
        <input 
            type="time" 
            class="form-control" 
            name="time_slots[]" 
            required
        >
        <input 
            type="number" 
            class="form-control" 
            name="spots_per_slot[]" 
            min="1" 
            max="50"
            placeholder="Spots available"
            required
        >
        <button type="button" class="btn-remove-slot" onclick="removeTimeSlot(this)">
            <i class="fas fa-trash"></i>
        </button>
    `;
    container.appendChild(newRow);
}

function removeTimeSlot(button) {
    const container = document.getElementById('timeSlotsContainer');
    const rows = container.getElementsByClassName('time-slot-row');
    
    // Don't allow removing the last row
    if (rows.length > 1) {
        button.closest('.time-slot-row').remove();
    } else {
        alert('You must have at least one time slot!');
    }
}

// Set minimum date to today
document.addEventListener('DOMContentLoaded', function() {
    const dateInput = document.querySelector('input[name="date"]');
    const today = new Date().toISOString().split('T')[0];
    dateInput.setAttribute('min', today);
});
</script>
{% endblock %}
